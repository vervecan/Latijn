<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Oz/Vz - Verbum Detective - Sessie 3</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            background: white;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            margin-bottom: 30px;
            text-align: center;
        }

        .header h1 {
            color: #4facfe;
            margin-bottom: 10px;
            font-size: 2.5em;
        }

        .header p {
            color: #666;
            font-size: 1.1em;
        }

        .progress-bar {
            background: white;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .progress-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-weight: bold;
        }

        .progress {
            width: 100%;
            height: 30px;
            background: #e0e0e0;
            border-radius: 15px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4facfe, #00f2fe);
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            text-align: center;
        }

        .stat-value {
            font-size: 2em;
            font-weight: bold;
            color: #4facfe;
        }

        .stat-label {
            color: #666;
            margin-top: 5px;
        }

        .fase {
            display: none;
            background: white;
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            animation: fadeIn 0.5s;
        }

        .fase.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .fase-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 3px solid #4facfe;
        }

        .fase-header h2 {
            color: #4facfe;
            font-size: 1.8em;
        }

        .timer {
            font-size: 1.5em;
            font-weight: bold;
            color: #00f2fe;
        }

        .help-box {
            background: #e8f4f8;
            border-left: 5px solid #4facfe;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .help-box h4 {
            color: #4facfe;
            margin-bottom: 10px;
        }

        .help-box ul {
            margin-left: 20px;
            margin-top: 10px;
        }

        .help-box li {
            margin: 5px 0;
        }

        .memory-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin: 30px 0;
        }

        .memory-card {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            height: 150px;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
            color: white;
            font-weight: bold;
            font-size: 1.2em;
            text-align: center;
            padding: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .memory-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.3);
        }

        .memory-card.flipped {
            background: white;
            color: #333;
            border: 3px solid #4facfe;
        }

        .memory-card.matched {
            background: #10b981;
            color: white;
            cursor: default;
            animation: pulse 0.5s;
        }

        .memory-card.wrong {
            background: #ef4444;
            animation: shake 0.5s;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }

        .question-card {
            background: #f8f9fa;
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
            border-left: 5px solid #4facfe;
        }

        .latin-text {
            font-size: 1.4em;
            font-style: italic;
            color: #333;
            line-height: 1.8;
            margin-bottom: 20px;
        }

        .latin-text .highlight {
            background: linear-gradient(to top, #ffd700 50%, transparent 50%);
            padding: 2px 4px;
            font-weight: bold;
        }

        .type-selector {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin: 20px 0;
        }

        .type-btn {
            background: white;
            border: 3px solid #4facfe;
            padding: 20px;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
            font-size: 1.1em;
            font-weight: bold;
            color: #4facfe;
        }

        .type-btn:hover {
            background: #4facfe;
            color: white;
            transform: translateY(-3px);
        }

        .type-btn.selected {
            background: #4facfe;
            color: white;
        }

        .type-btn.correct {
            background: #10b981;
            border-color: #10b981;
            color: white;
        }

        .type-btn.incorrect {
            background: #ef4444;
            border-color: #ef4444;
            color: white;
        }

        .verbum-category {
            background: #fff8dc;
            border: 3px solid #daa520;
            padding: 15px;
            border-radius: 10px;
            margin: 10px 0;
            cursor: pointer;
            transition: all 0.3s;
        }

        .verbum-category:hover {
            background: #daa520;
            color: white;
            transform: translateX(5px);
        }

        .verbum-category.selected {
            background: #daa520;
            color: white;
        }

        .translation-input {
            width: 100%;
            padding: 15px;
            font-size: 1.1em;
            border: 3px solid #4facfe;
            border-radius: 10px;
            margin: 15px 0;
            font-family: inherit;
        }

        .translation-input:focus {
            outline: none;
            border-color: #00f2fe;
            box-shadow: 0 0 10px rgba(79, 172, 254, 0.3);
        }

        .feedback {
            margin-top: 20px;
            padding: 20px;
            border-radius: 10px;
            display: none;
        }

        .feedback.show {
            display: block;
            animation: slideDown 0.3s;
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .feedback.correct {
            background: #d1fae5;
            border-left: 5px solid #10b981;
        }

        .feedback.incorrect {
            background: #fee2e2;
            border-left: 5px solid #ef4444;
        }

        .feedback.partial {
            background: #fef3c7;
            border-left: 5px solid #f59e0b;
        }

        .action-buttons {
            display: flex;
            gap: 15px;
            margin-top: 30px;
            justify-content: center;
        }

        .btn {
            padding: 15px 40px;
            border: none;
            border-radius: 10px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-primary {
            background: #4facfe;
            color: white;
        }

        .btn-primary:hover {
            background: #3a8cd4;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(79, 172, 254, 0.3);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #5a6268;
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .achievement {
            background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%);
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            margin-top: 20px;
            animation: pulse 1s infinite;
        }

        .badge {
            display: inline-block;
            background: #4facfe;
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            margin: 5px;
            font-size: 0.9em;
        }

        .hint-box {
            background: #fef3c7;
            border-left: 5px solid #f59e0b;
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
        }

        .hint-box h5 {
            color: #f59e0b;
            margin-bottom: 5px;
        }

        .schema-box {
            background: white;
            border: 3px solid #4facfe;
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
        }

        .schema-box h4 {
            color: #4facfe;
            margin-bottom: 15px;
        }

        .schema-row {
            display: grid;
            grid-template-columns: 1fr 2fr 2fr;
            gap: 10px;
            padding: 10px;
            border-bottom: 1px solid #eee;
        }

        .schema-row.header {
            background: #4facfe;
            color: white;
            font-weight: bold;
            border-radius: 5px;
        }

        .comparison-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }

        .comparison-item {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 15px;
            border: 3px solid #ccc;
        }

        .comparison-item h4 {
            color: #4facfe;
            margin-bottom: 10px;
        }

        .hero-story {
            background: linear-gradient(135deg, #ffeaa7 0%, #fdcb6e 100%);
            padding: 25px;
            border-radius: 15px;
            margin: 20px 0;
            border-left: 5px solid #e17055;
        }

        .hero-story h4 {
            color: #d63031;
            margin-bottom: 10px;
        }

        .leaderboard {
            background: white;
            padding: 20px;
            border-radius: 15px;
            margin-top: 20px;
        }

        .leaderboard-item {
            display: flex;
            justify-content: space-between;
            padding: 15px;
            border-bottom: 2px solid #eee;
            align-items: center;
        }

        .difficulty-badge {
            display: inline-block;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 0.9em;
            font-weight: bold;
            margin-left: 10px;
        }

        .difficulty-badge.easy {
            background: #d1fae5;
            color: #10b981;
        }

        .difficulty-badge.medium {
            background: #fef3c7;
            color: #f59e0b;
        }

        .difficulty-badge.hard {
            background: #fee2e2;
            color: #ef4444;
        }

        @media (max-width: 768px) {
            .memory-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .type-selector {
                grid-template-columns: 1fr;
            }

            .comparison-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🕵️ Verbum Detective - Sessie 3</h1>
            <p>Onderwerps- en Voorwerpszinnen</p>
        </div>

        <div class="progress-bar">
            <div class="progress-info">
                <span id="current-fase">Fase 1 van 4</span>
                <span id="total-time">Tijd: 0:00</span>
            </div>
            <div class="progress">
                <div class="progress-fill" id="progress-fill" style="width: 0%">0%</div>
            </div>
        </div>

        <div class="stats">
            <div class="stat-card">
                <div class="stat-value" id="score">0</div>
                <div class="stat-label">🎯 Score</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="correct">0</div>
                <div class="stat-label">✅ Correct</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="mistakes">0</div>
                <div class="stat-label">❌ Fouten</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="mastery">0%</div>
                <div class="stat-label">📊 Beheersing</div>
            </div>
        </div>

        <!-- FASE 1: Verbum Categorizer -->
        <div class="fase active" id="fase1">
            <div class="fase-header">
                <h2>Fase 1: Verbum Categorizer (25 min)</h2>
                <div class="timer" id="timer1">25:00</div>
            </div>

            <div class="help-box">
                <h4>🎯 Memory Game: Match werkwoorden met categorieën!</h4>
                <p>Klik op twee kaarten om ze om te draaien. Match werkwoorden met hun categorie.</p>
                <ul>
                    <li><strong>Declarandi:</strong> zeggen, berichten (dicere, narrare)</li>
                    <li><strong>Sentiendi:</strong> waarnemen, denken (videre, putare, scire)</li>
                    <li><strong>Volendi:</strong> wensen, willen (velle, cupere, optare)</li>
                    <li><strong>Timendi:</strong> vrezen (timere, vereri)</li>
                    <li><strong>Impediendi:</strong> verhinderen (impedire, prohibere)</li>
                    <li><strong>Rogandi:</strong> vragen (rogare, quaerere)</li>
                </ul>
            </div>

            <div class="memory-grid" id="memory-grid"></div>

            <div class="feedback" id="fase1-feedback"></div>

            <div class="action-buttons">
                <button class="btn btn-secondary" onclick="resetMemory()">🔄 Reset</button>
                <button class="btn btn-primary" onclick="nextFase(2)" style="display:none" id="fase1-next">Naar Fase 2 →</button>
            </div>
        </div>

        <!-- FASE 2: Type Identifier -->
        <div class="fase" id="fase2">
            <div class="fase-header">
                <h2>Fase 2: Type Identifier (30 min)</h2>
                <div class="timer" id="timer2">30:00</div>
            </div>

            <div class="help-box">
                <h4>🔍 Bepaal het type Oz/Vz!</h4>
                <p><strong>Mededelend:</strong> vertelt een feit → a+i of ut/ne + conj (bij Oz)</p>
                <p><strong>Vragend:</strong> stelt een vraag → vraagwoord + conj</p>
                <p><strong>Volitief:</strong> drukt wens/bevel uit → ut/ne + conj of a+i</p>
            </div>

            <div class="schema-box">
                <h4>📋 Beslisboom</h4>
                <div class="schema-row header">
                    <div>Hoofdwerkwoord</div>
                    <div>a+i-zin</div>
                    <div>ut/ne + conj</div>
                </div>
                <div class="schema-row">
                    <div><strong>Onpers ww / est + NWD</strong></div>
                    <div>Mededelend (Oz)</div>
                    <div>Mededelend (Oz)</div>
                </div>
                <div class="schema-row">
                    <div><strong>Verbum declarandi</strong></div>
                    <div>Mededelend (Vz)</div>
                    <div>Volitief (Vz)</div>
                </div>
                <div class="schema-row">
                    <div><strong>Verbum sentiendi</strong></div>
                    <div>Mededelend (Vz)</div>
                    <div>Volitief (Vz)</div>
                </div>
                <div class="schema-row">
                    <div><strong>Verbum volendi</strong></div>
                    <div>Volitief (Vz)</div>
                    <div>Volitief (Vz)</div>
                </div>
            </div>

            <div id="type-identifier-container"></div>

            <div class="action-buttons">
                <button class="btn btn-primary" id="check-type" onclick="checkType()">Controleer</button>
                <button class="btn btn-primary" id="next-type" onclick="nextType()" style="display:none">Volgende →</button>
            </div>
        </div>

        <!-- FASE 3: Translation Marathon -->
        <div class="fase" id="fase3">
            <div class="fase-header">
                <h2>Fase 3: Translation Marathon (25 min)</h2>
                <div class="timer" id="timer3">25:00</div>
            </div>

            <div class="hero-story">
                <h4>💕 Het Verhaal van Hero en Leander</h4>
                <p>Hero was een priesteres van Aphrodite in Sestos. Leander, een jongeman uit Abydos aan de overkant van de Hellespont, werd verliefd op haar. Elke nacht zwom hij door de zeestraat naar haar toe, geleid door een lamp die Hero in haar toren aanstack. Op een stormachtige nacht doofde de lamp en verdronk Leander. Toen Hero zijn lichaam op het strand vond, stortte ze zich van de toren.</p>
            </div>

            <div class="help-box">
                <h4>🌊 Vertaal de zinnen over Hero en Leander</h4>
                <p>Let goed op het type Oz/Vz en vertaal natuurlijk Nederlands!</p>
            </div>

            <div id="translation-container"></div>

            <div class="action-buttons">
                <button class="btn btn-primary" id="check-translation" onclick="checkTranslation()">Controleer</button>
                <button class="btn btn-primary" id="next-translation" onclick="nextTranslation()" style="display:none">Volgende →</button>
            </div>
        </div>

        <!-- FASE 4: Reflection & Final Test -->
        <div class="fase" id="fase4">
            <div class="fase-header">
                <h2>Fase 4: Finale Test (10 min)</h2>
                <div class="timer" id="timer4">10:00</div>
            </div>

            <div class="help-box">
                <h4>🏆 Bewijs je meesterschap!</h4>
                <p>Combineer alles wat je geleerd hebt: herken de categorie, bepaal het type en vertaal!</p>
            </div>

            <div id="final-container"></div>

            <div class="action-buttons">
                <button class="btn btn-primary" id="check-final" onclick="checkFinal()">Controleer</button>
                <button class="btn btn-primary" id="next-final" onclick="nextFinal()" style="display:none">Volgende →</button>
                <button class="btn btn-primary" onclick="showResults()" style="display:none" id="show-results">Bekijk Resultaten 🎉</button>
            </div>
        </div>
    </div>

    <script>
        // Data
        const memoryCards = [
            { id: 1, content: "dicere", type: "verb", category: "declarandi" },
            { id: 2, content: "Declarandi", type: "category", category: "declarandi" },
            { id: 3, content: "videre", type: "verb", category: "sentiendi" },
            { id: 4, content: "Sentiendi", type: "category", category: "sentiendi" },
            { id: 5, content: "velle", type: "verb", category: "volendi" },
            { id: 6, content: "Volendi", type: "category", category: "volendi" },
            { id: 7, content: "timere", type: "verb", category: "timendi" },
            { id: 8, content: "Timendi", type: "category", category: "timendi" },
            { id: 9, content: "impedire", type: "verb", category: "impediendi" },
            { id: 10, content: "Impediendi", type: "category", category: "impediendi" },
            { id: 11, content: "rogare", type: "verb", category: "rogandi" },
            { id: 12, content: "Rogandi", type: "category", category: "rogandi" },
        ];

        const typeQuestions = [
            {
                sentence: "Leander Heroni <span class='highlight'>se nocte adventurum esse</span> pollicitus est.",
                verbum: "pollicitus est (verba declarandi - beloven)",
                bijzin: "a+i",
                type: "Mededelend Vz",
                explanation: "A+i-zin bij verbum declarandi → mededelend. Leander beloofde Hero dat hij 's nachts zou komen.",
                difficulty: "easy"
            },
            {
                sentence: "Leander Heroni imperavit <span class='highlight'>ut lumen in turri poneret</span>.",
                verbum: "imperavit (verba volendi - bevelen)",
                bijzin: "ut + conj",
                type: "Volitief Vz",
                explanation: "Ut + conj bij verbum volendi → volitief. Leander beval Hero om een lamp in de toren te plaatsen.",
                difficulty: "easy"
            },
            {
                sentence: "<span class='highlight'>Leandro magnum animum fuisse</span> constat.",
                verbum: "constat (onpersoonlijk werkwoord)",
                bijzin: "a+i",
                type: "Mededelend Oz",
                explanation: "A+i-zin bij onpersoonlijk werkwoord → mededelend Oz. Het staat vast dat Leander een groot hart had.",
                difficulty: "medium"
            },
            {
                sentence: "Parentes nesciverunt <span class='highlight'>quid in animo haberet</span> Leander.",
                verbum: "nesciverunt (verba declarandi)",
                bijzin: "vraagwoord + conj",
                type: "Vragend Vz",
                explanation: "Vraagwoord + conj → altijd vragend. De ouders wisten niet wat Leander van plan was.",
                difficulty: "easy"
            },
            {
                sentence: "Accidit <span class='highlight'>ut atrox tempestas oreretur</span>.",
                verbum: "accidit (onpersoonlijk werkwoord)",
                bijzin: "ut + conj",
                type: "Mededelend Oz",
                explanation: "Ut + conj bij onpers ww → mededelend Oz. Het gebeurde dat een vreselijke storm opstak.",
                difficulty: "medium"
            },
            {
                sentence: "Hero timebat <span class='highlight'>ne Leander tempestate impediretur</span>.",
                verbum: "timebat (verba timendi)",
                bijzin: "ne + conj",
                type: "Volitief Vz",
                explanation: "Ne + conj bij verbum timendi → volitief (vrees). Hero vreesde dat Leander door de storm gehinderd zou worden.",
                difficulty: "hard"
            },
            {
                sentence: "Narrant <span class='highlight'>Heroni magnum dolorem fuisse</span>.",
                verbum: "narrant (verba declarandi)",
                bijzin: "a+i",
                type: "Mededelend Vz",
                explanation: "A+i bij verbum declarandi → mededelend. Ze vertellen dat Hero groot verdriet had.",
                difficulty: "medium"
            },
            {
                sentence: "Hero optavit <span class='highlight'>ut Leander tuto navigaret</span>.",
                verbum: "optavit (verba volendi)",
                bijzin: "ut + conj",
                type: "Volitief Vz",
                explanation: "Ut + conj bij verbum volendi → volitief. Hero wenste dat Leander veilig zou varen.",
                difficulty: "easy"
            }
        ];

        const translationQuestions = [
            {
                latin: "Leander Heroni se nocte adventurum esse pollicitus est.",
                type: "Mededelend Vz (a+i)",
                hints: ["pollicitus est = heeft beloofd", "se = zichzelf (Leander)", "adventurum esse = zal komen"],
                acceptedTranslations: [
                    "Leander beloofde Hero dat hij 's nachts zou komen",
                    "Leander heeft Hero beloofd dat hij 's nachts zou komen",
                    "Leander beloofde aan Hero dat hij in de nacht zou aankomen"
                ],
                keywords: ["beloof", "nachts", "kom", "aan"]
            },
            {
                latin: "Leander Heroni imperavit ut lumen in turri poneret.",
                type: "Volitief Vz (ut + conj)",
                hints: ["imperavit = beval", "lumen = lamp", "turris = toren", "poneret = zou plaatsen"],
                acceptedTranslations: [
                    "Leander beval Hero om een lamp in de toren te plaatsen",
                    "Leander beval Hero een lamp in de toren te zetten",
                    "Leander gaf Hero de opdracht een lamp in de toren te plaatsen"
                ],
                keywords: ["beval", "lamp", "toren", "plaats", "zet"]
            },
            {
                latin: "Leandro magnum animum fuisse constat.",
                type: "Mededelend Oz (a+i)",
                hints: ["constat = het staat vast", "magnum animum = groot hart (= dapper)", "fuisse = is geweest"],
                acceptedTranslations: [
                    "Het staat vast dat Leander een groot hart had",
                    "Het is zeker dat Leander dapper was",
                    "Het staat vast dat Leander moedig was"
                ],
                keywords: ["vast", "zeker", "dapper", "moedig", "groot hart"]
            },
            {
                latin: "Parentes nesciverunt quid in animo haberet Leander.",
                type: "Vragend Vz (vraagwoord + conj)",
                hints: ["nesciverunt = wisten niet", "quid = wat", "in animo habere = van plan zijn", "haberet = zou hebben/was"],
                acceptedTranslations: [
                    "De ouders wisten niet wat Leander van plan was",
                    "De ouders wisten niet wat Leander in gedachten had",
                    "De ouders wisten niet wat voor plan Leander had"
                ],
                keywords: ["ouders", "wist", "plan", "gedacht"]
            },
            {
                latin: "Accidit ut atrox tempestas oreretur.",
                type: "Mededelend Oz (ut + conj)",
                hints: ["accidit = het gebeurde", "atrox = vreselijk", "tempestas = storm", "oreretur = zou opsteken"],
                acceptedTranslations: [
                    "Het gebeurde dat een vreselijke storm opstak",
                    "Het gebeurde dat een hevige storm opkwam",
                    "Het geschiedde dat een verschrikkelijke storm ontstond"
                ],
                keywords: ["gebeur", "storm", "opstak", "opkwam", "ontstond", "vreselijk", "hevig"]
            },
            {
                latin: "Hero timebat ne Leander tempestate impediretur.",
                type: "Volitief Vz (ne + conj)",
                hints: ["timebat = vreesde", "ne = dat (bij vrees)", "tempestate = door de storm", "impediretur = zou gehinderd worden"],
                acceptedTranslations: [
                    "Hero vreesde dat Leander door de storm gehinderd zou worden",
                    "Hero was bang dat Leander door de storm tegengehouden zou worden",
                    "Hero vreesde dat de storm Leander zou hinderen"
                ],
                keywords: ["vrees", "bang", "storm", "hinder", "tegenhoud"]
            }
        ];

        const finalQuestions = [
            {
                latin: "Caesar milites hortatus est <span class='highlight'>ut fortiter pugnarent</span>.",
                questions: [
                    { 
                        q: "Welke categorie werkwoord is 'hortatus est'?", 
                        options: ["Declarandi", "Volendi", "Sentiendi"], 
                        correct: "Volendi",
                        explanation: "Hortari = aansporen, dat is een wilsuiting → volendi"
                    },
                    { 
                        q: "Welk type bijzin is 'ut fortiter pugnarent'?", 
                        options: ["Mededelend", "Vragend", "Volitief"], 
                        correct: "Volitief",
                        explanation: "Ut + conj bij verbum volendi → volitief"
                    }
                ],
                translation: "Caesar spoorde de soldaten aan om dapper te vechten"
            },
            {
                latin: "Constat <span class='highlight'>Caesarem ducem optimum fuisse</span>.",
                questions: [
                    { 
                        q: "Wat voor werkwoord is 'constat'?", 
                        options: ["Onpersoonlijk ww", "Verbum declarandi", "Verbum sentiendi"], 
                        correct: "Onpersoonlijk ww",
                        explanation: "Constat = het staat vast → onpersoonlijk werkwoord"
                    },
                    { 
                        q: "Welk type bijzin is dit?", 
                        options: ["Mededelend Oz", "Mededelend Vz", "Volitief Oz"], 
                        correct: "Mededelend Oz",
                        explanation: "A+i bij onpers ww → mededelend Oz"
                    }
                ],
                translation: "Het staat vast dat Caesar de beste aanvoerder was"
            },
            {
                latin: "Nescio <span class='highlight'>quis hoc fecerit</span>.",
                questions: [
                    { 
                        q: "Welke categorie is 'nescio'?", 
                        options: ["Declarandi", "Sentiendi", "Rogandi"], 
                        correct: "Declarandi",
                        explanation: "Nescire = niet weten → declarandi"
                    },
                    { 
                        q: "Welk type bijzin?", 
                        options: ["Mededelend", "Vragend", "Volitief"], 
                        correct: "Vragend",
                        explanation: "Vraagwoord (quis) + conj → altijd vragend"
                    }
                ],
                translation: "Ik weet niet wie dit gedaan heeft"
            },
            {
                latin: "Miles timuit <span class='highlight'>ne a duce puniretur</span>.",
                questions: [
                    { 
                        q: "Welke categorie is 'timuit'?", 
                        options: ["Timendi", "Volendi", "Impediendi"], 
                        correct: "Timendi",
                        explanation: "Timere = vrezen → timendi"
                    },
                    { 
                        q: "Welk type bijzin?", 
                        options: ["Mededelend", "Vragend", "Volitief"], 
                        correct: "Volitief",
                        explanation: "Ne + conj bij verbum timendi → volitief (vrees)"
                    }
                ],
                translation: "De soldaat vreesde dat hij door de aanvoerder gestraft zou worden"
            }
        ];

        // State
        let score = 0;
        let correct = 0;
        let mistakes = 0;
        let flippedCards = [];
        let matchedPairs = 0;
        let currentType = 0;
        let currentTranslation = 0;
        let currentFinal = 0;
        let startTime = Date.now();
        let typeAnswers = {};
        let finalAnswers = {};

        // Timer
        function startTimer(minutes, elementId) {
            let seconds = minutes * 60;
            const timerElement = document.getElementById(elementId);
            
            const interval = setInterval(() => {
                const mins = Math.floor(seconds / 60);
                const secs = seconds % 60;
                timerElement.textContent = `${mins}:${secs.toString().padStart(2, '0')}`;
                seconds--;
                
                if (seconds < 0) {
                    clearInterval(interval);
                }
            }, 1000);
        }

        // Update total time
        setInterval(() => {
            const elapsed = Math.floor((Date.now() - startTime) / 1000);
            const mins = Math.floor(elapsed / 60);
            const secs = elapsed % 60;
            document.getElementById('total-time').textContent = `Tijd: ${mins}:${secs.toString().padStart(2, '0')}`;
        }, 1000);

        // Fase 1: Memory Game
        function initMemory() {
            const shuffled = [...memoryCards].sort(() => Math.random() - 0.5);
            const grid = document.getElementById('memory-grid');
            
            grid.innerHTML = shuffled.map(card => `
                <div class="memory-card" data-id="${card.id}" data-category="${card.category}" onclick="flipCard(${card.id})">
                    <div class="card-content">?</div>
                </div>
            `).join('');
        }

        function flipCard(id) {
            if (flippedCards.length >= 2) return;
            
            const card = document.querySelector(`[data-id="${id}"]`);
            if (card.classList.contains('flipped') || card.classList.contains('matched')) return;
            
            const cardData = memoryCards.find(c => c.id === id);
            card.classList.add('flipped');
            card.querySelector('.card-content').textContent = cardData.content;
            
            flippedCards.push({ id, category: cardData.category, element: card });
            
            if (flippedCards.length === 2) {
                setTimeout(checkMatch, 1000);
            }
        }

        function checkMatch() {
            const [card1, card2] = flippedCards;
            
            if (card1.category === card2.category) {
                card1.element.classList.add('matched');
                card2.element.classList.add('matched');
                matchedPairs++;
                score += 10;
                correct++;
                
                if (matchedPairs === 6) {
                    showAchievement("🎉 Alle paren gevonden!");
                    document.getElementById('fase1-next').style.display = 'inline-block';
                }
            } else {
                card1.element.classList.add('wrong');
                card2.element.classList.add('wrong');
                mistakes++;
                
                setTimeout(() => {
                    card1.element.classList.remove('flipped', 'wrong');
                    card2.element.classList.remove('flipped', 'wrong');
                    card1.element.querySelector('.card-content').textContent = '?';
                    card2.element.querySelector('.card-content').textContent = '?';
                }, 500);
            }
            
            flippedCards = [];
            updateStats();
        }

        function resetMemory() {
            flippedCards = [];
            matchedPairs = 0;
            initMemory();
        }

        // Fase 2: Type Identifier
        function loadTypeQuestion() {
            if (currentType >= typeQuestions.length) {
                showAchievement("Fase 2 Voltooid! 🔍 Type Expert!");
                setTimeout(() => nextFase(3), 2000);
                return;
            }

            const q = typeQuestions[currentType];
            const container = document.getElementById('type-identifier-container');
            
            container.innerHTML = `
                <div class="question-card">
                    <p><strong>Vraag ${currentType + 1}/${typeQuestions.length}</strong> 
                    <span class="difficulty-badge ${q.difficulty}">${q.difficulty === 'easy' ? 'Makkelijk' : q.difficulty === 'medium' ? 'Gemiddeld' : 'Moeilijk'}</span></p>
                    <div class="latin-text">${q.sentence}</div>
                    
                    <div class="hint-box">
                        <h5>💡 Hulp:</h5>
                        <p><strong>Hoofdwerkwoord:</strong> ${q.verbum}</p>
                        <p><strong>Type bijzin:</strong> ${q.bijzin}</p>
                    </div>

                    <p><strong>Bepaal het type Oz/Vz:</strong></p>
                    <div class="type-selector">
                        <div class="type-btn" onclick="selectType('Mededelend Oz')">Mededelend Oz</div>
                        <div class="type-btn" onclick="selectType('Mededelend Vz')">Mededelend Vz</div>
                        <div class="type-btn" onclick="selectType('Vragend Vz')">Vragend Vz</div>
                        <div class="type-btn" onclick="selectType('Volitief Oz')">Volitief Oz</div>
                        <div class="type-btn" onclick="selectType('Volitief Vz')">Volitief Vz</div>
                    </div>
                    
                    <div class="feedback" id="type-feedback"></div>
                </div>
            `;
        }

        function selectType(type) {
            document.querySelectorAll('.type-btn').forEach(btn => btn.classList.remove('selected'));
            event.target.classList.add('selected');
            typeAnswers[currentType] = type;
        }

        function checkType() {
            const q = typeQuestions[currentType];
            const userAnswer = typeAnswers[currentType];
            
            if (!userAnswer) {
                alert("Kies eerst een type!");
                return;
            }

            const buttons = document.querySelectorAll('.type-btn');
            buttons.forEach(btn => {
                if (btn.textContent === q.type) {
                    btn.classList.add('correct');
                } else if (btn.textContent === userAnswer) {
                    btn.classList.add('incorrect');
                }
            });

            const feedback = document.getElementById('type-feedback');
            feedback.classList.add('show');

            if (userAnswer === q.type) {
                feedback.classList.add('correct');
                feedback.innerHTML = `<h3>✅ Correct!</h3><p>${q.explanation}</p>`;
                const points = q.difficulty === 'easy' ? 10 : q.difficulty === 'medium' ? 15 : 20;
                score += points;
                correct++;
            } else {
                feedback.classList.add('incorrect');
                feedback.innerHTML = `<h3>❌ Niet helemaal</h3><p><strong>Juiste antwoord:</strong> ${q.type}</p><p>${q.explanation}</p>`;
                mistakes++;
            }

            updateStats();
            document.getElementById('check-type').style.display = 'none';
            document.getElementById('next-type').style.display = 'inline-block';
        }

        function nextType() {
            currentType++;
            updateProgress();
            document.getElementById('check-type').style.display = 'inline-block';
            document.getElementById('next-type').style.display = 'none';
            loadTypeQuestion();
        }

        // Fase 3: Translation
        function loadTranslation() {
            if (currentTranslation >= translationQuestions.length) {
                showAchievement("Fase 3 Voltooid! 🌊 Vertaalmeester!");
                setTimeout(() => nextFase(4), 2000);
                return;
            }

            const q = translationQuestions[currentTranslation];
            const container = document.getElementById('translation-container');
            
            container.innerHTML = `
                <div class="question-card">
                    <p><strong>Vraag ${currentTranslation + 1}/${translationQuestions.length}</strong></p>
                    <div class="latin-text">${q.latin}</div>
                    
                    <div class="hint-box">
                        <h5>💡 Hints:</h5>
                        ${q.hints.map(h => `<p>• ${h}</p>`).join('')}
                        <p><strong>Type:</strong> ${q.type}</p>
                    </div>

                    <p><strong>Jouw vertaling:</strong></p>
                    <input type="text" class="translation-input" id="translation-input" placeholder="Typ hier je Nederlandse vertaling...">
                    
                    <div class="feedback" id="translation-feedback"></div>
                </div>
            `;
        }

        function checkTranslation() {
            const q = translationQuestions[currentTranslation];
            const userAnswer = document.getElementById('translation-input').value.toLowerCase().trim();
            
            if (!userAnswer) {
                alert("Vul eerst een vertaling in!");
                return;
            }

            const feedback = document.getElementById('translation-feedback');
            feedback.classList.add('show');

            // Check if translation contains key elements
            const hasKeywords = q.keywords.every(keyword => 
                userAnswer.includes(keyword.toLowerCase())
            );

            if (hasKeywords) {
                feedback.classList.add('correct');
                feedback.innerHTML = `
                    <h3>✅ Goede vertaling!</h3>
                    <p><strong>Voorbeeldvertaling:</strong> ${q.acceptedTranslations[0]}</p>
                `;
                score += 20;
                correct++;
            } else {
                feedback.classList.add('partial');
                feedback.innerHTML = `
                    <h3>⚠️ Bijna goed</h3>
                    <p><strong>Jouw vertaling:</strong> ${userAnswer}</p>
                    <p><strong>Voorbeeldvertaling:</strong> ${q.acceptedTranslations[0]}</p>
                    <p><strong>Ontbrekende elementen:</strong> ${q.keywords.filter(k => !userAnswer.includes(k.toLowerCase())).join(', ')}</p>
                `;
                score += 10;
                mistakes++;
            }

            updateStats();
            document.getElementById('check-translation').style.display = 'none';
            document.getElementById('next-translation').style.display = 'inline-block';
        }

        function nextTranslation() {
            currentTranslation++;
            updateProgress();
            document.getElementById('check-translation').style.display = 'inline-block';
            document.getElementById('next-translation').style.display = 'none';
            loadTranslation();
        }

        // Fase 4: Final Test
        function loadFinal() {
            if (currentFinal >= finalQuestions.length) {
                document.getElementById('check-final').style.display = 'none';
                document.getElementById('next-final').style.display = 'none';
                document.getElementById('show-results').style.display = 'inline-block';
                return;
            }

            const q = finalQuestions[currentFinal];
            const container = document.getElementById('final-container');
            
            container.innerHTML = `
                <div class="question-card">
                    <p><strong>Vraag ${currentFinal + 1}/${finalQuestions.length}</strong></p>
                    <div class="latin-text">${q.latin}</div>
                    
                    ${q.questions.map((subq, idx) => `
                        <div style="margin: 20px 0; padding: 20px; background: white; border-radius: 10px; border: 2px solid #4facfe;">
                            <p><strong>${subq.q}</strong></p>
                            <div class="type-selector" style="margin-top: 15px;">
                                ${subq.options.map(opt => `
                                    <div class="type-btn" onclick="selectFinalAnswer(${idx}, '${opt}')">${opt}</div>
                                `).join('')}
                            </div>
                        </div>
                    `).join('')}
                    
                    <div style="margin: 20px 0; padding: 20px; background: white; border-radius: 10px; border: 2px solid #4facfe;">
                        <p><strong>Vertaal de zin:</strong></p>
                        <input type="text" class="translation-input" id="final-translation-${currentFinal}" 
                               placeholder="Typ hier je Nederlandse vertaling...">
                    </div>
                    
                    <div class="feedback" id="final-feedback"></div>
                </div>
            `;
        }

        function selectFinalAnswer(questionIndex, answer) {
            if (!finalAnswers[currentFinal]) finalAnswers[currentFinal] = {};
            finalAnswers[currentFinal][questionIndex] = answer;
            
            // Visual feedback
            const buttons = event.target.parentElement.querySelectorAll('.type-btn');
            buttons.forEach(btn => btn.classList.remove('selected'));
            event.target.classList.add('selected');
        }

        function checkFinal() {
            const q = finalQuestions[currentFinal];
            const userAnswers = finalAnswers[currentFinal] || {};
            const userTranslation = document.getElementById(`final-translation-${currentFinal}`).value.toLowerCase().trim();
            
            if (Object.keys(userAnswers).length !== q.questions.length || !userTranslation) {
                alert("Beantwoord alle vragen en geef een vertaling!");
                return;
            }

            const feedback = document.getElementById('final-feedback');
            feedback.classList.add('show');

            let correctCount = 0;
            let feedbackHTML = '<h3>Resultaat:</h3>';

            // Check multiple choice questions
            q.questions.forEach((subq, idx) => {
                const isCorrect = userAnswers[idx] === subq.correct;
                if (isCorrect) {
                    correctCount++;
                    feedbackHTML += `<p>✅ <strong>Vraag ${idx + 1}:</strong> Correct! ${subq.explanation}</p>`;
                } else {
                    feedbackHTML += `<p>❌ <strong>Vraag ${idx + 1}:</strong> Fout. Juiste antwoord: ${subq.correct}. ${subq.explanation}</p>`;
                }
            });

            // Check translation (simplified check)
            const hasTranslation = userTranslation.length > 10;
            feedbackHTML += `<p><strong>Jouw vertaling:</strong> ${userTranslation}</p>`;
            feedbackHTML += `<p><strong>Voorbeeldvertaling:</strong> ${q.translation}</p>`;

            if (correctCount === q.questions.length && hasTranslation) {
                feedback.classList.add('correct');
                score += 30;
                correct += q.questions.length + 1;
            } else if (correctCount > 0) {
                feedback.classList.add('partial');
                score += correctCount * 10;
                correct += correctCount;
                mistakes += (q.questions.length - correctCount);
            } else {
                feedback.classList.add('incorrect');
                mistakes += q.questions.length;
            }

            feedback.innerHTML = feedbackHTML;
            updateStats();
            document.getElementById('check-final').style.display = 'none';
            document.getElementById('next-final').style.display = 'inline-block';
        }

        function nextFinal() {
            currentFinal++;
            updateProgress();
            document.getElementById('check-final').style.display = 'inline-block';
            document.getElementById('next-final').style.display = 'none';
            loadFinal();
        }

        // Results
        function showResults() {
            const totalQuestions = 6 + typeQuestions.length + translationQuestions.length + (finalQuestions.length * 3);
            const percentage = ((correct / totalQuestions) * 100).toFixed(1);
            
            let badges = [];
            if (percentage >= 90) badges.push("🏆 Oz/Vz Master");
            if (percentage >= 80) badges.push("⭐ Grammatica Expert");
            if (percentage >= 70) badges.push("📚 Verba Kenner");
            if (mistakes <= 3) badges.push("💎 Precisie Pro");
            if (score >= 300) badges.push("🎯 Hoge Scorer");
            
            const container = document.querySelector('.fase.active');
            container.innerHTML = `
                <div style="text-align: center;">
                    <h2 style="color: #4facfe; margin-bottom: 30px;">🎉 Sessie 3 Voltooid!</h2>
                    
                    <div class="achievement">
                        <h3>Je Resultaten</h3>
                        <div style="font-size: 3em; margin: 20px 0;">${percentage}%</div>
                        <p style="font-size: 1.2em;">Score: ${score} punten</p>
                        <p>Correct: ${correct} | Fouten: ${mistakes}</p>
                    </div>
                    
                    <div style="margin: 30px 0;">
                        <h3 style="color: #4facfe; margin-bottom: 15px;">🏅 Behaalde Badges</h3>
                        ${badges.map(b => `<span class="badge">${b}</span>`).join('')}
                    </div>
                    
                    <div class="help-box" style="text-align: left;">
                        <h4>📊 Jouw Analyse</h4>
                        <p><strong>Totale score:</strong> ${score} XP</p>
                        <p><strong>Correcte antwoorden:</strong> ${correct}/${totalQuestions}</p>
                        <p><strong>Nauwkeurigheid:</strong> ${percentage}%</p>
                        <br>
                        <h4>💡 Tips voor Sessie 4</h4>
                        ${percentage >= 80 
                            ? '<p>Geweldig! Je beheerst Oz/Vz goed. In sessie 4 gaan we verder met BWBz.</p>' 
                            : '<p>Herhaal het verschil tussen mededelend, vragend en volitief. Focus op de verba-categorieën en de beslisboom.</p>'}
                        <br>
                        <h4>🎯 Wat je nu beheerst:</h4>
                        <p>✅ Verba-categorieën (declarandi, sentiendi, volendi, etc.)</p>
                        <p>✅ Verschil tussen mededelend, vragend en volitief</p>
                        <p>✅ Oz versus Vz herkennen</p>
                        <p>✅ A+i-zin versus ut/ne + conj</p>
                        <p>✅ Natuurlijk vertalen van Oz/Vz</p>
                    </div>
                    
                    <div class="action-buttons">
                        <button class="btn btn-secondary" onclick="location.reload()">🔄 Opnieuw Doen</button>
                        <button class="btn btn-primary" onclick="alert('Sessie 4 komt binnenkort! 🚀')">Naar Sessie 4 →</button>
                    </div>
                </div>
            `;
        }

        // Utility Functions
        function updateStats() {
            document.getElementById('score').textContent = score;
            document.getElementById('correct').textContent = correct;
            document.getElementById('mistakes').textContent = mistakes;
            
            const totalQuestions = 6 + typeQuestions.length + translationQuestions.length + (finalQuestions.length * 3);
            const answeredQuestions = correct + mistakes;
            const mastery = answeredQuestions > 0 ? ((correct / answeredQuestions) * 100).toFixed(0) : 0;
            document.getElementById('mastery').textContent = mastery + '%';
        }

        function updateProgress() {
            const total = 6 + typeQuestions.length + translationQuestions.length + (finalQuestions.length * 3);
            const completed = matchedPairs + currentType + currentTranslation + (currentFinal * 3);
            const percentage = (completed / total) * 100;
            
            document.getElementById('progress-fill').style.width = percentage + '%';
            document.getElementById('progress-fill').textContent = Math.round(percentage) + '%';
        }

        function nextFase(faseNum) {
            document.querySelectorAll('.fase').forEach(f => f.classList.remove('active'));
            document.getElementById(`fase${faseNum}`).classList.add('active');
            document.getElementById('current-fase').textContent = `Fase ${faseNum} van 4`;
            
            if (faseNum === 2) {
                loadTypeQuestion();
                startTimer(30, 'timer2');
            } else if (faseNum === 3) {
                loadTranslation();
                startTimer(25, 'timer3');
            } else if (faseNum === 4) {
                loadFinal();
                startTimer(10, 'timer4');
            }
            
            updateProgress();
        }

        function showAchievement(text) {
            const existing = document.querySelector('.achievement');
            if (existing && !existing.innerHTML.includes('Je Resultaten')) existing.remove();
            
            const achievement = document.createElement('div');
            achievement.className = 'achievement';
            achievement.innerHTML = `<h3>${text}</h3>`;
            document.querySelector('.container').appendChild(achievement);
            
            setTimeout(() => achievement.remove(), 3000);
        }

        // Initialize
        initMemory();
        startTimer(25, 'timer1');
        updateStats();
    </script>
</body>
</html>
